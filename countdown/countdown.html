<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="utf-8">
    <title>MoN Takanawa: The Museum of Narratives - Countdown</title>
    <style>
        /* @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@100..900&display=swap'); */

        @font-face {
            font-family: 'NotoSansJP';
            src: url('../fonts/Noto_Sans_JP/NotoSansJP-VariableFont_wght.ttf') format('truetype');
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            /* デバッグ用 */
            /* border: orangered 1px solid;  */
        }

        body {
            overflow: hidden;
            background: #000;
            /* font-family: "Noto Sans JP", system-ui, -apple-system, BlinkMacSystemFont, sans-serif; */
            font-family: "NotoSansJP", sans-serif;
            font-optical-sizing: auto;
            /* font-weight: <weight>; */
            font-style: normal;
            color: #e6e6e6;
            height: 100vh;
            width: 100vw;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        #content {
            position: fixed;
            z-index: 10;
            top: 8%;
            text-align: center;
        }

        .museum-name {
            font-size: 5vw;
            margin-bottom: 1vw;
            text-shadow: 0 0 20px rgba(0, 0, 0, 0.9);
            letter-spacing: 2px;
        }

        .museum-subtitle {
            font-size: 5vw;
            margin-bottom: 1vw;
            text-shadow: 0 0 20px rgba(0, 0, 0, 0.9);
            letter-spacing: 1px;
        }

        .label {
            font-size: 4vw;
            margin-bottom: 5vw;
            text-shadow: 0 0 15px rgba(0, 0, 0, 0.9);
        }

        .countdown-section {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10vw;
            /* margin-bottom: 1vw; */
        }

        .countdown-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .number {
            font-size: 12vw;
            font-weight: bold;
            line-height: 1;
            text-shadow: 0 0 30px rgba(0, 0, 0, 0.8);
        }

        .unit {
            font-size: 3vw;
            margin-top: 2vw;
            text-shadow: 0 0 15px rgba(0, 0, 0, 0.8);
        }
    </style>
</head>

<body>
    <div id="content">
        <div class="museum-name">MoN Takanawa:</div>
        <div class="museum-subtitle">The Museum of Narratives</div>
        <div class="label">開館まで</div>
        <div class="countdown-section">
            <div class="countdown-item">
                <div class="number" id="days">0</div>
                <div class="unit">days</div>
            </div>
            <div class="countdown-item">
                <div class="number" id="weeks">0</div>
                <div class="unit">weeks</div>
            </div>
        </div>
    </div>

    <script>
        let targetDate;
        let bubbles = [];
        const themeColors = [
            [255, 0, 0],     // #FF0000 
            [106, 208, 116], // #6AD074 
            [0, 28, 176]     // #001CB0 
        ];

        function setup() {
            createCanvas(windowWidth, windowHeight);
            frameRate(24);
            updateCountdown();
            targetDate = new Date(2026, 2, 27, 0, 0, 0);

            const now = new Date();
            const diffMs = targetDate - now;
            const dayMs = 1000 * 60 * 60 * 24;
            let daysLeft = Math.ceil(diffMs / dayMs);
            if (daysLeft < 0) daysLeft = 0;

            baseCircleSize = Math.min(width, height) * 0.3;
            let velocity = 0.5;
            // 
            for (let i = 0; i < daysLeft; i++) {
                let colorChoice;
                const rand = random(1);
                if (rand < 0.90) { // 90%
                    colorChoice = random(themeColors);
                } else { // 10%                    
                    const gray = random(100, 180);
                    colorChoice = [gray, gray, gray];
                }

                bubbles.push({
                    x: random(width),
                    y: random(height),
                    r: random(baseCircleSize * 0.1, baseCircleSize),
                    vx: random(-velocity, velocity),
                    vy: random(-velocity, velocity),
                    alpha: random(100, 250),
                    color: colorChoice
                });
            }
            textAlign(CENTER, CENTER);
        }

        function windowResized() {
            console.log('Window resized:', windowWidth, windowHeight);
            resizeCanvas(windowWidth, windowHeight);
        }

        function draw() {
            background(0);
            noStroke();
            // 描画と移動
            for (let b of bubbles) {
                fill(b.color[0], b.color[1], b.color[2], b.alpha);
                ellipse(b.x, b.y, b.r, b.r);
                b.x += b.vx;
                b.y += b.vy;
                if (b.x < -b.r) b.x = width + b.r;
                if (b.x > width + b.r) b.x = -b.r;
                if (b.y < -b.r) b.y = height + b.r;
                if (b.y > height + b.r) b.y = -b.r;
            }

            // 背景を半透明で上書きして残像効果
            fill(0, 140);
            rect(0, 0, width, height);
        }

        function updateCountdown() {
            const targetDate = new Date(2026, 2, 27, 0, 0, 0);
            const now = new Date();
            const diffMs = targetDate - now;
            const dayMs = 1000 * 60 * 60 * 24;
            let daysLeft = Math.ceil(diffMs / dayMs);
            if (daysLeft < 0) daysLeft = 0;

            const weeksLeft = (daysLeft / 7).toFixed(1);
            document.getElementById('days').textContent = daysLeft;
            document.getElementById('weeks').textContent = weeksLeft;
        }
        setInterval(updateCountdown, 1000 * 60); // 1分ごとに更新
    </script>
    <script src="../p5.min.js"></script>
</body>

</html>